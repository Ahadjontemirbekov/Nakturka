<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        body {
            margin: 0;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(-45deg, #ff6b6b, #f8e473, #4ecdc4, #5a81f7);
            background-size: 400% 400%;
            animation: gradientBG 12s ease infinite;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body>

<script>
document.addEventListener("DOMContentLoaded", function() {

    if (!navigator.geolocation) {
        alert("Sizning brauzeringiz geolokatsiyani qo‘llamaydi!");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        function(pos) {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;

            console.log("Location:", lat, lon);

            fetch("{% url 'index' id %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                body: JSON.stringify({
                    latitude: lat,
                    longitude: lon
                })
            })
            .then(res => res.json())
            .then(data => console.log(data));
        },

        function(error) {
            if (error.code === error.PERMISSION_DENIED) {
                alert("⛔ Lokatsiya olishga ruxsat bermadingiz! Iltimos 'Allow' bosing.");
            } else if (error.code === error.POSITION_UNAVAILABLE) {
                alert("❌ Lokatsiya aniqlanmadi.");
            } else if (error.code === error.TIMEOUT) {
                alert("⌛ Lokatsiyani olish juda uzoq davom etdi.");
            } else {
                alert("Noma'lum xatolik yuz berdi.");
            }

            console.log(error);
        },

        {
            enableHighAccuracy: true,
            timeout: 7000,
            maximumAge: 0
        }
    );
});
</script>


</body>
</html>
